"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.canDeleteProjectPolicy = void 0;
const result_1 = require("true-myth/result");
const constants_js_1 = require("../../../core/constants.js");
const server_js_1 = require("../../fragments/server.js");
const canUpdate_js_1 = require("./canUpdate.js");
const canDeleteProjectPolicy = (loaders) => async ({ userId, projectId }) => {
    // Server admins can also delete projects
    const ensuredAdminAccess = await (0, server_js_1.ensureMinimumServerRoleFragment)(loaders)({
        userId,
        role: constants_js_1.Roles.Server.Admin
    });
    if (ensuredAdminAccess.isOk) {
        return (0, result_1.ok)();
    }
    // Otherwise follow standard canUpdate check
    const ensuredCanUpdate = await (0, canUpdate_js_1.canUpdateProjectPolicy)(loaders)({
        userId,
        projectId
    });
    return ensuredCanUpdate;
};
exports.canDeleteProjectPolicy = canDeleteProjectPolicy;
//# sourceMappingURL=canDelete.js.map